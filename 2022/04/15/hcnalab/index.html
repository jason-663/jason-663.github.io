<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="《HCNA网络技术实验指南》实验, 废物的摸鱼日常">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- <script src="../../../../js/forbid.js"></script> -->
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>《HCNA网络技术实验指南》实验 | 废物的摸鱼日常</title>
    <link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/css/matery.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/css/my.css">

    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/jquery/jquery.min.js"></script>
    <!-- <script src="js/forbid.js"></script> -->
<meta name="generator" content="Hexo 5.4.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">废物的摸鱼日常</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">废物的摸鱼日常</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        var testV = 1;
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将关闭当前页！');
                // location.href = '/';
                window.open("about:blank","_self").close();
            }
        }
        // if (() & (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex))){
        //     window.open("about:blank","_self").close();
        // }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/featureimages/23.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">《HCNA网络技术实验指南》实验</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        /* padding-bottom: 30px; */
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }

    .style-scrollbar::-webkit-scrollbar {
        width: 10px;
        background-color: #F5F5F5;
    }

    .style-scrollbar::-webkit-scrollbar-thumb {
        background-color: #0ae;
        border-radius: 10px;
        background-image: -webkit-gradient(linear, 0 0, 0 100%,
                color-stop(.5, rgba(255, 255, 255, .2)),
                color-stop(.5, transparent), to(transparent));
    }

    .style-scrollbar::-webkit-scrollbar-track {
        -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        background-color: rgb(255, 255, 255);
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">笔记</span>
                            </a>
                        
                            <a href="/tags/%E7%BD%91%E7%BB%9C/">
                                <span class="chip bg-color">网络</span>
                            </a>
                        
                            <a href="/tags/%E8%BF%90%E7%BB%B4/">
                                <span class="chip bg-color">运维</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">
                                笔记
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-04-15
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2022-04-21
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    55 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="第一章-ensp与vrp的基础操作"><a href="#第一章-ensp与vrp的基础操作" class="headerlink" title="第一章 ensp与vrp的基础操作"></a>第一章 ensp与vrp的基础操作</h2><h3 id="内容描述"><a href="#内容描述" class="headerlink" title="内容描述"></a>内容描述</h3><h3 id="实例详情"><a href="#实例详情" class="headerlink" title="实例详情"></a>实例详情</h3><p>实验说明：配置telnet登录，使得可以通过ar1上的telnet进行远程访问<br>拓扑图：<img src="../../../../medias/network/1/1.1.png" alt="拓扑图"><br>编址：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>ar1</td>
<td>g0/0/0</td>
<td>10.1.1.254</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>ar2</td>
<td>g0/0/0</td>
<td>10.1.1.1</td>
<td>24</td>
<td>10.1.1.254</td>
</tr>
<tr>
<td>ar3</td>
<td>g0/0/0</td>
<td>10.1.1.20</td>
<td>24</td>
<td>10.1.1.254</td>
</tr>
</tbody></table>
<p>配置过程：<br>1.先将计划的IP地址分配到相应的设备和对应端口上，完成之后测试联通性</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Huawei</span><span class="token punctuation">></span></span>
Apr 13 2022 09:54:12-08:00 Huawei %%01IFPDT/4/IF<span class="token italic"><span class="token punctuation">_</span>STATE(l)[0]:Interface GigabitEt
hernet0/0/0 has turned into UP state.
&lt;Huawei>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]int g0/0/0
[Huawei-GigabitEthernet0/0/0]ip add 10.1.1.254 24
Apr 13 2022 09:55:10-08:00 Huawei %%01IFNET/4/LINK<span class="token punctuation">_</span></span>STATE(l)[1]:The line protocol
 IP on the interface GigabitEthernet0/0/0 has entered the UP state. 
[Huawei-GigabitEthernet0/0/0]
</code></pre>
<p>ar2与ar3配置命令相似<br>2.配置telnet登录验证</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Huawei</span><span class="token punctuation">></span></span>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]user-inter    
[Huawei]user-interface vty 0 4
[Huawei-ui-vty0-4]aut    
[Huawei-ui-vty0-4]authentication-mode pass    
[Huawei-ui-vty0-4]authentication-mode password
Please configure the login password (maximum length 16):huawei
[Huawei-ui-vty0-4]q
[Huawei]
</code></pre>
<p>这时通过其他两个任何一个路由器输入<code>telnet 10.1.1.254</code>，并输入密码，即可进入ar1的做界面<br>如果分不清到底是不是ar1的路由器，可以先将ar1路由器内的名称改为ar1，先进入配置视图（[Huawei]）然后输入<code>sysname 名称</code>。</p>
<h2 id="第二章-交换机基础配置"><a href="#第二章-交换机基础配置" class="headerlink" title="第二章 交换机基础配置"></a>第二章 交换机基础配置</h2><h3 id="内容描述-1"><a href="#内容描述-1" class="headerlink" title="内容描述"></a>内容描述</h3><h3 id="实例详情-1"><a href="#实例详情-1" class="headerlink" title="实例详情"></a>实例详情</h3><p>实验说明：三台交换机，1和2是接入，3是汇聚，交换机之间使用全双工，并配置接口速率<br>拓扑图：<img src="../../../../medias/network/2/2.1.png" alt="拓扑图"><br>编址：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>pc1</td>
<td>e0/0/1</td>
<td>10.1.1.1</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc2</td>
<td>e0/0/1</td>
<td>10.1.1.2</td>
<td>24</td>
<td>-</td>
</tr>
</tbody></table>
<p>配置过程：<br>先为PC配置好IP地址和子网掩码，并在其中一台pc机ping另一台pc机的IP地址，检查连通性<br>接下来配置交换机<br>1.配置交换机双工模式<br>配置前，由于交换机的自协商协议默认为开启状态，需先将该协议关闭，在进行配置</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Huawei</span><span class="token punctuation">></span></span>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]int g0/0/1
[Huawei-GigabitEthernet0/0/1]undo ne
[Huawei-GigabitEthernet0/0/1]undo negotiation au
[Huawei-GigabitEthernet0/0/1]undo negotiation auto 
[Huawei-GigabitEthernet0/0/1]dupl
[Huawei-GigabitEthernet0/0/1]duplex 
Apr 13 2022 11:11:22-08:00 Huawei DS/4/DATASYNC<span class="token italic"><span class="token punctuation">_</span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of records is 4095.fu
[Huawei-GigabitEthernet0/0/1]duplex full 
[Huawei-GigabitEthernet0/0/1]
Apr 13 2022 11:11:32-08:00 Huawei DS/4/DATASYNC<span class="token punctuation">_</span></span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of records is 4095.
[Huawei-GigabitEthernet0/0/1]
</code></pre>
<p>上下的三个端口分别配置此命令，至此，交换机间的工作模式全部切换为了全双工。<br>2.配置接口速率<br>由于用户（PC）较少，所以将GE口配置为100mbit/s，e口配置为10Mbit/s；配置前，由于交换机的自协商协议默认为开启状态，需先将该协议关闭，在进行配置</p>
<pre class=" language-markdown"><code class="language-markdown"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Huawei</span><span class="token punctuation">></span></span>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]sys s1
[s1]int 
Apr 13 2022 11:22:42-08:00 s1 DS/4/DATASYNC<span class="token italic"><span class="token punctuation">_</span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.e0/0/1
[s1-Ethernet0/0/1]un
[s1-Ethernet0/0/1]undo ne
[s1-Ethernet0/0/1]undo negotiation au
[s1-Ethernet0/0/1]undo negotiation auto 
[s1-Ethernet0/0/1]sp
[s1-Ethernet0/0/1]speed 
Apr 13 2022 11:23:02-08:00 s1 DS/4/DATASYNC<span class="token punctuation">_</span></span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.10
[s1-Ethernet0/0/1]
Apr 13 2022 11:23:12-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/1]int g0/0/1
[s1-GigabitEthernet0/0/1]  
</code></pre>
<p>注意每一个端口都要单独关掉</p>
<h4 id="arp与proxy-arp"><a href="#arp与proxy-arp" class="headerlink" title="arp与proxy arp"></a>arp与proxy arp</h4><p>实验说明：r1，s1，s2，配置静态arp且在路由器上配置arp代理<br>拓扑图：<img src="../../../../medias/network/2/2.2.png" alt="拓扑图"><br>编址：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>r1</td>
<td>g0/0/1</td>
<td>10.1.1.254</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>r1</td>
<td>g0/0/2</td>
<td>10.2.254</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc1</td>
<td>e0/0/1</td>
<td>10.1.1.1</td>
<td>16</td>
<td>-</td>
</tr>
<tr>
<td>pc2</td>
<td>e0/0/1</td>
<td>10.1.1.2</td>
<td>16</td>
<td>-</td>
</tr>
<tr>
<td>pc3</td>
<td>e0/0/1</td>
<td>10.1.2.3</td>
<td>16</td>
<td>-</td>
</tr>
</tbody></table>
<p>配置过程：<br>按照编址表将IP地址配置到各个位置，<br>配置静态arp</p>
<pre class=" language-markdown"><code class="language-markdown">[r1]arp static 10.1.1.1 5489-983D-766A   
[r1]arp static 10.1.1.2 5489-9857-45FC   
[r1]arp static 10.1.2.3 5489-9812-085E   
[r1]
</code></pre>
<p>配置proxy arp<br>华为交换机默认代理arp是关闭状态，上面的两个网段是不能相互访问的，需要将对应网段接口的代理arp打开</p>
<pre class=" language-markdown"><code class="language-markdown">[r1]int g0/0/1
[r1-GigabitEthernet0/0/1]arp-pr
[r1-GigabitEthernet0/0/1]arp-proxy en
[r1-GigabitEthernet0/0/1]arp-proxy enable 
[r1-GigabitEthernet0/0/1]int g0/0/2
[r1-GigabitEthernet0/0/2]arp-pr
[r1-GigabitEthernet0/0/2]arp-proxy 
[r1-GigabitEthernet0/0/2]arp-proxy en
[r1-GigabitEthernet0/0/2]
</code></pre>
<p>这样10.1.1.0网段就能和10.1.2.0网段通信了</p>
<h2 id="第三章-valn"><a href="#第三章-valn" class="headerlink" title="第三章 valn"></a>第三章 valn</h2><h3 id="内容描述-2"><a href="#内容描述-2" class="headerlink" title="内容描述"></a>内容描述</h3><h3 id="实例详情-2"><a href="#实例详情-2" class="headerlink" title="实例详情"></a>实例详情</h3><h4 id="access"><a href="#access" class="headerlink" title="access"></a>access</h4><p>实验说明：只允许同部门可互相通信；配置access接口和vlan的基本配置<br>拓扑图：<img src="../../../../medias/network/3/3.1.png" alt="拓扑图"><br>编址：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>pc1</td>
<td>e0/0/1</td>
<td>10.1.1.1</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc2</td>
<td>e0/0/1</td>
<td>10.1.1.2</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc3</td>
<td>e0/0/1</td>
<td>10.1.1.3</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc4</td>
<td>e0/0/1</td>
<td>10.1.1.4</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc5</td>
<td>e0/0/1</td>
<td>10.1.1.5</td>
<td>24</td>
<td>-</td>
</tr>
</tbody></table>
<p>配置步骤：<br>按照编址表将IP地址分配到pc机上，并检查连通性<br>接下来创建vlan；默认存在vlan1，且所有接口都被划分在了vlan1中<br>先创建10和20两个vlan<br>然后在使用vlan bath同时创建两个vlan<br>完成之后查看一下当前设备中vlan的相关信息</p>
<pre class=" language-md"><code class="language-md">[s1]
[s1]vlan 10
[s1-vlan10]vlan 20
[s1-vlan20]vlan 
Apr 15 2022 16:32:00-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.b
[s1-vlan20]vlan b
[s1-vlan20]vlan ba
[s1-vlan20]q      
[s1]vlan batch 30 40
Info: This operation may take a few seconds. Please wait for a moment...done.
[s1]
Apr 15 2022 16:32:30-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.
[s1]dis vlan
The total number of vlans is : 5
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/2(U)     Eth0/0/3(U)     Eth0/0/4(D)     
                Eth0/0/5(U)     Eth0/0/6(D)     Eth0/0/7(D)     Eth0/0/8(D)     
                Eth0/0/9(D)     Eth0/0/10(D)    Eth0/0/11(D)    Eth0/0/12(D)    
                Eth0/0/13(D)    Eth0/0/14(D)    Eth0/0/15(D)    Eth0/0/16(D)    
                Eth0/0/17(D)    Eth0/0/18(D)    Eth0/0/19(D)    Eth0/0/20(D)    
                Eth0/0/21(D)    Eth0/0/22(D)    GE0/0/1(D)      GE0/0/2(D)      
10   common  
20   common  
30   common  
40   common  

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
30   enable  default       enable  disable    VLAN 0030                         
40   enable  default       enable  disable    VLAN 0040                         
[s1]

<Huawei>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]sys s2
[s2]vlan batch 40 4
Apr 15 2022 16:36:11-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of rvlan batch 30 40
Info: This operation may take a few seconds. Please wait for a moment...done.
[s2]
Apr 15 2022 16:36:31-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of records is 4095.
[s2]dis vlan
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/2(U)     Eth0/0/3(D)     Eth0/0/4(D)     
                Eth0/0/5(U)     Eth0/0/6(D)     Eth0/0/7(D)     Eth0/0/8(D)     
                Eth0/0/9(D)     Eth0/0/10(D)    Eth0/0/11(D)    Eth0/0/12(D)    
                Eth0/0/13(D)    Eth0/0/14(D)    Eth0/0/15(D)    Eth0/0/16(D)    
                Eth0/0/17(D)    Eth0/0/18(D)    Eth0/0/19(D)    Eth0/0/20(D)    
                Eth0/0/21(D)    Eth0/0/22(D)    GE0/0/1(D)      GE0/0/2(D)      
30   common  
40   common  

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
30   enable  default       enable  disable    VLAN 0030                         
40   enable  default       enable  disable    VLAN 0040                         
[s2]
</code></pre>
<p>配置access<br>将所有连接交换机的的端口都配置为access，并配置接口的默认vlan同时加入到相应的vlan中</p>
<pre class=" language-markdown"><code class="language-markdown">[s2]int e0/0/1
[s2-Ethernet0/0/1]port lin 
[s2-Ethernet0/0/1]port link-ty
[s2-Ethernet0/0/1]port link-type ass
[s2-Ethernet0/0/1]port link-type a  
[s2-Ethernet0/0/1]port link-type access 
[s2-Ethernet0/0/1]
Apr 15 2022 16:49:12-08:00 s2 DS/4/DATASYNC<span class="token italic"><span class="token punctuation">_</span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.por
[s2-Ethernet0/0/1]port de     
[s2-Ethernet0/0/1]port default vlan 30
[s2-Ethernet0/0/1]int e0
Apr 15 2022 16:50:42-08:00 s2 DS/4/DATASYNC<span class="token punctuation">_</span></span>CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095./0/2
[s2-Ethernet0/0/2]po
[s2-Ethernet0/0/2]port lin
[s2-Ethernet0/0/2]port link-t
[s2-Ethernet0/0/2]port link-type acc
[s2-Ethernet0/0/2]port link-type access 
[s2-Ethernet0/0/2]po
[s2-Ethernet0/0/2]portde
[s2-Ethernet0/0/2]port de
[s2-Ethernet0/0/2]port default vlan 
Apr 15 2022 16:51:12-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.40
[s2-Ethernet0/0/2]


</code></pre>
<p>然后再看一下vlan信息</p>
<pre class=" language-md"><code class="language-md">[s1]dis vlan 
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/4(D)     Eth0/0/5(U)     Eth0/0/6(D)     Eth0/0/7(D)     
                Eth0/0/8(D)     Eth0/0/9(D)     Eth0/0/10(D)    Eth0/0/11(D)    
                Eth0/0/12(D)    Eth0/0/13(D)    Eth0/0/14(D)    Eth0/0/15(D)    
                Eth0/0/16(D)    Eth0/0/17(D)    Eth0/0/18(D)    Eth0/0/19(D)    
                Eth0/0/20(D)    Eth0/0/21(D)    Eth0/0/22(D)    GE0/0/1(D)      
                GE0/0/2(D)                                                      
10   common  UT:Eth0/0/1(U)     Eth0/0/2(U)                                     
20   common  UT:Eth0/0/3(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
[s1]



[s2]dis vlan 
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/3(D)     Eth0/0/4(D)     Eth0/0/5(U)     Eth0/0/6(D)     
                Eth0/0/7(D)     Eth0/0/8(D)     Eth0/0/9(D)     Eth0/0/10(D)    
                Eth0/0/11(D)    Eth0/0/12(D)    Eth0/0/13(D)    Eth0/0/14(D)    
                Eth0/0/15(D)    Eth0/0/16(D)    Eth0/0/17(D)    Eth0/0/18(D)    
                Eth0/0/19(D)    Eth0/0/20(D)    Eth0/0/21(D)    Eth0/0/22(D)    
                GE0/0/1(D)      GE0/0/2(D)                                      
30   common  UT:Eth0/0/1(U)                                                     
40   common  UT:Eth0/0/2(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
30   enable  default       enable  disable    VLAN 0030                         
40   enable  default       enable  disable    VLAN 0040                         
[s2]
</code></pre>
<p>可以看到俩个交换机连接各个pc的端口都已划分到对应的vlan中，接下来验证结果，验证pc1能否与pc2，pc3通信</p>
<pre class=" language-md"><code class="language-md">PC>ping 10.1.1.2

Ping 10.1.1.2: 32 data bytes, Press Ctrl_C to break
From 10.1.1.2: bytes=32 seq=1 ttl=128 time=32 ms
From 10.1.1.2: bytes=32 seq=2 ttl=128 time=47 ms
From 10.1.1.2: bytes=32 seq=3 ttl=128 time=63 ms
From 10.1.1.2: bytes=32 seq=4 ttl=128 time=46 ms
From 10.1.1.2: bytes=32 seq=5 ttl=128 time=47 ms

--- 10.1.1.2 ping statistics ---
  5 packet(s) transmitted
  5 packet(s) received
  0.00% packet loss
  round-trip min/avg/max = 32/47/63 ms

PC>ping 10.1.1.3

Ping 10.1.1.3: 32 data bytes, Press Ctrl_C to break
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable

--- 10.1.1.3 ping statistics ---
  5 packet(s) transmitted
  0 packet(s) received
  100.00% packet loss

PC>
</code></pre>
<p>可以看到，pc1与pc2在同一个广播域中（vlan）中，可以通信，但是与pc3不在一个广播域中，不可以通信</p>
<h4 id="trunk"><a href="#trunk" class="headerlink" title="trunk"></a>trunk</h4><p>实验内容：<br>拓扑图：<img src="../../../../medias/network/3/3.2.png" alt="拓扑图"><br>编址表：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>pc1</td>
<td>e0/0/1</td>
<td>10.1.1.1</td>
<td>255.255.255.0</td>
<td>-</td>
</tr>
<tr>
<td>pc2</td>
<td>e0/0/1</td>
<td>10.1.1.2</td>
<td>255.255.255.0</td>
<td>-</td>
</tr>
<tr>
<td>pc3</td>
<td>e0/0/1</td>
<td>10.1.1.3</td>
<td>255.255.255.0</td>
<td>-</td>
</tr>
<tr>
<td>pc4</td>
<td>e0/0/1</td>
<td>10.1.1.4</td>
<td>255.255.255.0</td>
<td>-</td>
</tr>
</tbody></table>
<p>配置过程：<br>首先在三台交换机上配置vlan</p>
<pre class=" language-md"><code class="language-md"><Huawei>
<Huawei>
<Huawei>sy
Enter system view, return user view with Ctrl+Z.
[Huawei]
[Huawei]sys s1
[s1]
Apr 19 2022 09:59:57-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of records is 4095.
[s1]vlan batch 10 20
Info: This operation may take a few seconds. Please wait for a moment...done.
[s1]
Apr 19 2022 10:00:17-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of records is 4095.
[s1]vlan 10 
[s1-vlan10]de
[s1-vlan10]description ?
  TEXT  VLAN description(no more than 80 characters)

[s1-vlan10]description R$D
[s1-vlan10]
Apr 19 2022 10:01:47-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.
[s1-vlan10]vlan 20
[s1-vlan20]de
[s1-vlan20]description market
[s1-vlan20]
Apr 19 2022 10:06:47-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.q
[s1]dis vlan 


<Huawei>
<Huawei>sy
Enter system view, return user view with Ctrl+Z.
[Huawei]sys s2
[s2]vlan batch 10 
Apr 19 2022 10:00:30-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of records is 4095.20
Info: This operation may take a few seconds. Please wait for a moment...done.
[s2]
Apr 19 2022 10:00:40-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of records is 4095.
[s2]vlan 20
[s2-vlan20]de
[s2-vlan20]description mar
[s2-vlan20]description market
[s2-vlan20]
Apr 19 2022 10:05:30-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.
[s2-vlan20]vlan 10
[s2-vlan10]d
[s2-vlan10]de  
[s2-vlan10]description r$d
[s2-vlan10]
Apr 19 2022 10:05:50-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.
[s2-vlan10]


<Huawei>
<Huawei>
<Huawei>sy 
Enter system view, return user view with Ctrl+Z.
[Huawei]sys s3
[s3]vlan 10
[s3-vlan10]de
[s3-vlan10]description 
Apr 19 2022 10:05:59-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of records is 4095. r$d
[s3-vlan10]vlan 20
Apr 19 2022 10:06:19-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.
[s3-vlan20]de
[s3-vlan20]description market
[s3-vlan20]
Apr 19 2022 10:06:29-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.
[s3-vlan20]
</code></pre>
<p>其中：<br>description命令为描述的意思，起到解释说明的功能，r$d 代表研发部，market 代表市场部。<br>查看vlan情况，以s3为例</p>
<pre class=" language-md"><code class="language-md">[s3]dis vlan 
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:GE0/0/1(U)      GE0/0/2(U)      GE0/0/3(D)      GE0/0/4(D)      
                GE0/0/5(D)      GE0/0/6(D)      GE0/0/7(D)      GE0/0/8(D)      
                GE0/0/9(D)      GE0/0/10(D)     GE0/0/11(D)     GE0/0/12(D)     
                GE0/0/13(D)     GE0/0/14(D)     GE0/0/15(D)     GE0/0/16(D)     
                GE0/0/17(D)     GE0/0/18(D)     GE0/0/19(D)     GE0/0/20(D)     
                GE0/0/21(D)     GE0/0/22(D)     GE0/0/23(D)     GE0/0/24(D)     
10   common  
20   common  

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    r$d                               
20   enable  default       enable  disable    market                            
[s3]
</code></pre>
<p>在s1和s2上配置access接口以及相关配置</p>
<pre class=" language-md"><code class="language-md">[s1]int e0/0/2
[s1-Ethernet0/0/2]po
[s1-Ethernet0/0/2]portl
[s1-Ethernet0/0/2]port l
[s1-Ethernet0/0/2]port link-t
[s1-Ethernet0/0/2]port link-type ac
[s1-Ethernet0/0/2]port link-type access 
[s1-Ethernet0/0/2]por 
Apr 19 2022 10:23:38-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095 de vlan 10
[s1-Ethernet0/0/2]int 
Apr 19 2022 10:23:48-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 9, the change loop count is 0, and the maximum number of records is 4095.e0/0/3
[s1-Ethernet0/0/3]port link-type access
[s1-Ethernet0/0/3]por de vlan 10       
Apr 19 2022 10:23:58-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 10, the change loop count is 0, and the maximum number of records is 40920
[s1-Ethernet0/0/3]
Apr 19 2022 10:24:08-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/3]



[s2]int e 0/0/3
[s2-Ethernet0/0/3]port link-type accsee
                                 ^
Error: Unrecognized command found at '^' position.
[s2-Ethernet0/0/3]port link-t          
[s2-Ethernet0/0/3]port link-type acc
[s2-Ethernet0/0/3]port link-type access 
[s2-Ethernet0/0/3]por
[s2-Ethernet0/0/3]port d
[s2-Ethernet0/0/3]port de     
[s2-Ethernet0/0/3]port default vlan 10
Apr 19 2022 10:24:51-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/3]int 
Apr 19 2022 10:25:01-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 9, the change loop count is 0, and the maximum number of records is 4095.e0/0/4
[s2-Ethernet0/0/4]port link-type access
[s2-Ethernet0/0/4]port default vlan 10 
Apr 19 2022 10:25:11-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 10, the change loop count is 0, and the maximum number of records is 40920
[s2-Ethernet0/0/4]
Apr 19 2022 10:25:21-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/4]
</code></pre>
<p>在s1和s2上配置trunk以及相关配置</p>
<pre class=" language-md"><code class="language-md">[s1-Ethernet0/0/3]int e0/0/1
[s1-Ethernet0/0/1]por link-t trunk
[s1-Ethernet0/0/1]
Apr 19 2022 10:28:28-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095.por
[s1-Ethernet0/0/1]port tru
[s1-Ethernet0/0/1]port trunk all
[s1-Ethernet0/0/1]port trunk allow-pass vlan 10 20
[s1-Ethernet0/0/1]
Apr 19 2022 10:28:48-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 13, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/1]



[s2-Ethernet0/0/4]int e0/0/2
[s2-Ethernet0/0/2]por
[s2-Ethernet0/0/2]port link-t t
[s2-Ethernet0/0/2]port link-t trunk 
[s2-Ethernet0/0/2]por t
Apr 19 2022 10:29:31-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095. a vlan 10 20
[s2-Ethernet0/0/2]
Apr 19 2022 10:29:51-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 13, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/2]
</code></pre>
<p>在s3上配置trunk，并通过所有vlan，最后使用display port vlan查看vlan和接口配置情况</p>
<pre class=" language-md"><code class="language-md">[s3]int g0/0/1
[s3-GigabitEthernet0/0/1]por
[s3-GigabitEthernet0/0/1]port link-t t
[s3-GigabitEthernet0/0/1]port t a vlan all
Apr 19 2022 10:30:30-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 9, the change loop count is 0, and the maximum number of records is 4095.
[s3-GigabitEthernet0/0/1]int g0/0/2
[s3-GigabitEthernet0/0/2]port link-t t    
[s3-GigabitEthernet0/0/2]port t a vlan all
Apr 19 2022 10:30:40-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.
[s3-GigabitEthernet0/0/2]
Apr 19 2022 10:30:50-08:00 s3 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095.q
[s3]dis port vlan 
Port                    Link Type    PVID  Trunk VLAN List
-------------------------------------------------------------------------------
GigabitEthernet0/0/1    trunk        1     1-4094
GigabitEthernet0/0/2    trunk        1     1-4094
GigabitEthernet0/0/3    hybrid       1     -                                   
GigabitEthernet0/0/4    hybrid       1     -                                   
GigabitEthernet0/0/5    hybrid       1     -                                   
GigabitEthernet0/0/6    hybrid       1     -                                   
GigabitEthernet0/0/7    hybrid       1     -                                   
GigabitEthernet0/0/8    hybrid       1     -                                   
GigabitEthernet0/0/9    hybrid       1     -                                   
GigabitEthernet0/0/10   hybrid       1     -                                   
GigabitEthernet0/0/11   hybrid       1     -                                   
GigabitEthernet0/0/12   hybrid       1     -                                   
GigabitEthernet0/0/13   hybrid       1     -                                   
GigabitEthernet0/0/14   hybrid       1     -                                   
GigabitEthernet0/0/15   hybrid       1     -                                   
GigabitEthernet0/0/16   hybrid       1     -                                   
GigabitEthernet0/0/17   hybrid       1     -                                   
GigabitEthernet0/0/18   hybrid       1     -                                   
GigabitEthernet0/0/19   hybrid       1     -                                   
GigabitEthernet0/0/20   hybrid       1     -                                   
GigabitEthernet0/0/21   hybrid       1     -                                   
GigabitEthernet0/0/22   hybrid       1     -                                   
GigabitEthernet0/0/23   hybrid       1     -                                   
GigabitEthernet0/0/24   hybrid       1     -                                   
[s3] 
</code></pre>
<p>测试连通性，pc1与pc3的通信，pc2与pc4的通信</p>
<pre class=" language-md"><code class="language-md">PC>ping 10.1.1.3

Ping 10.1.1.3: 32 data bytes, Press Ctrl_C to break
From 10.1.1.3: bytes=32 seq=1 ttl=128 time=141 ms
From 10.1.1.3: bytes=32 seq=2 ttl=128 time=140 ms
From 10.1.1.3: bytes=32 seq=3 ttl=128 time=110 ms
From 10.1.1.3: bytes=32 seq=4 ttl=128 time=93 ms
From 10.1.1.3: bytes=32 seq=5 ttl=128 time=125 ms

--- 10.1.1.3 ping statistics ---
  5 packet(s) transmitted
  5 packet(s) received
  0.00% packet loss
  round-trip min/avg/max = 93/121/141 ms

PC>



PC>ping 10.1.1.4

Ping 10.1.1.4: 32 data bytes, Press Ctrl_C to break
From 10.1.1.4: bytes=32 seq=1 ttl=128 time=156 ms
From 10.1.1.4: bytes=32 seq=2 ttl=128 time=109 ms
From 10.1.1.4: bytes=32 seq=3 ttl=128 time=125 ms
From 10.1.1.4: bytes=32 seq=4 ttl=128 time=94 ms
From 10.1.1.4: bytes=32 seq=5 ttl=128 time=125 ms

--- 10.1.1.4 ping statistics ---
  5 packet(s) transmitted
  5 packet(s) received
  0.00% packet loss
  round-trip min/avg/max = 94/121/156 ms

PC>
</code></pre>
<p>检查pc1与pc2的连通性</p>
<pre class=" language-md"><code class="language-md">PC>ping 10.1.1.2

Ping 10.1.1.2: 32 data bytes, Press Ctrl_C to break
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable
From 10.1.1.1: Destination host unreachable

--- 10.1.1.2 ping statistics ---
  5 packet(s) transmitted
  0 packet(s) received
  100.00% packet loss

PC>
</code></pre>
<h4 id="hybrid"><a href="#hybrid" class="headerlink" title="hybrid"></a>hybrid</h4><p>实验内容：只允许部门内部通讯，部门之间不允许通讯；it部门可以访问所有部门<br>拓扑图：<img src="../../../../medias/network/3/3.3.png" alt="拓扑图"><br>编址表：</p>
<table>
<thead>
<tr>
<th>设备</th>
<th>接口</th>
<th>IP地址</th>
<th>子网掩码</th>
<th>默认网关</th>
</tr>
</thead>
<tbody><tr>
<td>pc1</td>
<td>e0/0/1</td>
<td>192.168.1.1</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc2</td>
<td>e0/0/1</td>
<td>192.168.1.2</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc3</td>
<td>e0/0/1</td>
<td>192.168.1.3</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc4</td>
<td>e0/0/1</td>
<td>192.168.1.4</td>
<td>24</td>
<td>-</td>
</tr>
<tr>
<td>pc5</td>
<td>e0/0/1</td>
<td>192.168.1.100</td>
<td>24</td>
<td>-</td>
</tr>
</tbody></table>
<p>配置步骤：<br>将IP地址按照编址表配置到对应位置<br>默认情况下，交换机上的所有接口地都处于hybrid状态，接口的pvid为vlan1.<br>下面按要求进行内通信，组隔离的配置</p>
<pre class=" language-md"><code class="language-md">[s1]vlan 10
[s1-vlan10]vlan 20
[s1-vlan20]
Apr 19 2022 15:24:58-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.
[s1-vlan20]int e0/0/2
[s1-Ethernet0/0/2]por
[s1-Ethernet0/0/2]port l
[s1-Ethernet0/0/2]port link-t a
[s1-Ethernet0/0/2]port 
Apr 19 2022 15:25:38-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.de vlan 20
[s1-Ethernet0/0/2]
Apr 19 2022 15:25:58-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/2]int e0/0/3     
[s1-Ethernet0/0/3]port link-t a  
[s1-Ethernet0/0/3]port de vlan 10
[s1-Ethernet0/0/3]
Apr 19 2022 15:26:28-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 10, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/3]
[s1-Ethernet0/0/3]int e0/0/1
[s1-Ethernet0/0/1]port link-t t
[s1-Ethernet0/0/1]port t all vlan a
Apr 19 2022 15:29:18-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.ll
[s1-Ethernet0/0/1]
Apr 19 2022 15:29:28-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/1]




[s2]vlan 10
[s2-vlan10]vlan 20
[s2-vlan20]int e0/0/
Apr 19 2022 15:27:10-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.2
[s2-Ethernet0/0/2]port link-t a
[s2-Ethernet0/0/2]port de a
                          ^
Error: Unrecognized command found at '^' position.
[s2-Ethernet0/0/2]
Apr 19 2022 15:27:30-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.port de vlan 20
[s2-Ethernet0/0/2]
Apr 19 2022 15:27:40-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.int e0/0/3     
[s2-Ethernet0/0/3]port de a      
                       ^
Error: Unrecognized command found at '^' position.
[s2-Ethernet0/0/3]port link-t a  
[s2-Ethernet0/0/3]port de vlan 10
[s2-Ethernet0/0/3]
Apr 19 2022 15:28:00-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 10, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/3]int e0/0/1
[s2-Ethernet0/0/1]por
[s2-Ethernet0/0/1]port l
[s2-Ethernet0/0/1]port link-t
[s2-Ethernet0/0/1]port link-type t
[s2-Ethernet0/0/1]por
[s2-Ethernet0/0/1]port t
[s2-Ethernet0/0/1]port trunk 
Apr 19 2022 15:28:30-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/1]port trunk ?
  allow-pass  Allowed vlan
  pvid        Specify current port's PVID VLAN characteristics

[s2-Ethernet0/0/1]port trunk all vlan all
[s2-Ethernet0/0/1]
Apr 19 2022 15:29:00-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/1]
</code></pre>
<p>查看一下vlan</p>
<pre class=" language-md"><code class="language-md">[s1]dis vlan
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/4(U)     Eth0/0/5(D)     Eth0/0/6(D)     
                Eth0/0/7(D)     Eth0/0/8(D)     Eth0/0/9(D)     Eth0/0/10(D)    
                Eth0/0/11(D)    Eth0/0/12(D)    Eth0/0/13(D)    Eth0/0/14(D)    
                Eth0/0/15(D)    Eth0/0/16(D)    Eth0/0/17(D)    Eth0/0/18(D)    
                Eth0/0/19(D)    Eth0/0/20(D)    Eth0/0/21(D)    Eth0/0/22(D)    
                GE0/0/1(D)      GE0/0/2(D)                                      
10   common  UT:Eth0/0/3(U)                                                     
             TG:Eth0/0/1(U)                                                     
20   common  UT:Eth0/0/2(U)                                                     
             TG:Eth0/0/1(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
[s1]




[s2]dis vlan 
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/4(D)     Eth0/0/5(D)     Eth0/0/6(D)     
                Eth0/0/7(D)     Eth0/0/8(D)     Eth0/0/9(D)     Eth0/0/10(D)    
                Eth0/0/11(D)    Eth0/0/12(D)    Eth0/0/13(D)    Eth0/0/14(D)    
                Eth0/0/15(D)    Eth0/0/16(D)    Eth0/0/17(D)    Eth0/0/18(D)    
                Eth0/0/19(D)    Eth0/0/20(D)    Eth0/0/21(D)    Eth0/0/22(D)    
                GE0/0/1(D)      GE0/0/2(D)                                      
10   common  UT:Eth0/0/3(U)                                                     
             TG:Eth0/0/1(U)                                                     
20   common  UT:Eth0/0/2(U)                                                     
             TG:Eth0/0/1(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
[s2]
</code></pre>
<p>接下来测试一下连通性</p>
<pre class=" language-md"><code class="language-md">PC>ping 192.168.1.3

Ping 192.168.1.3: 32 data bytes, Press Ctrl_C to break
From 192.168.1.3: bytes=32 seq=1 ttl=128 time=78 ms
From 192.168.1.3: bytes=32 seq=2 ttl=128 time=94 ms
From 192.168.1.3: bytes=32 seq=3 ttl=128 time=78 ms
From 192.168.1.3: bytes=32 seq=4 ttl=128 time=78 ms
From 192.168.1.3: bytes=32 seq=5 ttl=128 time=78 ms

--- 192.168.1.3 ping statistics ---
  5 packet(s) transmitted
  5 packet(s) received
  0.00% packet loss
  round-trip min/avg/max = 78/81/94 ms

PC>ping 192.168.1.2

Ping 192.168.1.2: 32 data bytes, Press Ctrl_C to break
From 192.168.1.1: Destination host unreachable
From 192.168.1.1: Destination host unreachable
From 192.168.1.1: Destination host unreachable
From 192.168.1.1: Destination host unreachable
From 192.168.1.1: Destination host unreachable

--- 192.168.1.2 ping statistics ---
  5 packet(s) transmitted
  0 packet(s) received
  100.00% packet loss

PC>
</code></pre>
<p>可以观察到，在单台交换机及跨交换机间的访问控制使用Trunk和Access类型接口实现了需求，但同样的需求使用Hybrid实现会更灵活。<br>S1的E 0/0/2接口连接PC-1主机，该接口收到的PC-1发送的Untagged的帧会被交换机转发到VLAN 20。同样，交换机从其他接口收到VLAN 20的发往PC-1的帧也会以Untagged的方式从E 0/0/2接口发送。S1的E 0/0/3接口连接PC-2主机，该接口收到Untagged的帧会被转发到VLAN 10。如果交换机收到的VLAN 10的发往PC-2的帧也会以Untagged的方式从接口E 0/0/3发送。VLAN 10和VLAN 20的帧也要经过交换机间链路发送至邻居交换机S2。反之，S1收到来自邻居交换机S2的Tagged的帧后，也会根据VLAN Tag转发到相应的VLAN。<br>接下来先将刚刚配置完成的端口恢复成默认配置，再根据hybrid类型的特性和实验要求进行配置；先恢复默认vlan，再恢复接口类型。<br>先恢复s1上的e0/0/2</p>
<pre class=" language-md"><code class="language-md">[s1]int e0/0/2
[s1-Ethernet0/0/2]undo port de vlan
[s1-Ethernet0/0/2]
Apr 21 2022 09:24:31-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 1, the change loop count is 0, and the maximum number of records is 4095.port link-t h
[s1-Ethernet0/0/2]
Apr 21 2022 09:24:51-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 2, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/2]
</code></pre>
<p>然后配置vlan tag剥离，使得数据包在进行转发时，剥离掉vlan tag，以untagged的方式发送</p>
<pre class=" language-md"><code class="language-md">[s1-Ethernet0/0/2]port hybrid untagged vlan 20
[s1-Ethernet0/0/2]
Apr 21 2022 09:27:01-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 3, the change loop count is 0, and the maximum number of records is 4095.
</code></pre>
<p>配置该接口hybrid的默认vlan id，即该端口在接收到pc发来的未带vlan tag的数据包时，加上指定vlan tag，并转发到对应vlan中</p>
<pre class=" language-md"><code class="language-md">[s1-Ethernet0/0/2]port hybrid pvid vlan 20
[s1-Ethernet0/0/2]
Apr 21 2022 09:27:21-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of records is 4095.
</code></pre>
<p>在s1的e0/0/3端口上做相应配置</p>
<pre class=" language-md"><code class="language-md">[s1]int e0/0/3
[s1-Ethernet0/0/3]undo port de vlan
[s1-Ethernet0/0/3]port link-t h     
[s1-Ethernet0/0/3]
Apr 21 2022 11:44:06-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 6, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/3]port hy pvid vlan 10
[s1-Ethernet0/0/3]port hy un vlan 10
Apr 21 2022 11:44:26-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/3]
</code></pre>
<p>s1的e0/0/1端口负责跨交换机通信，按照需求，需要将vlan10和vlan20两个广播域的数据包发送过去</p>
<pre class=" language-md"><code class="language-md">[s1-Ethernet0/0/1]port hybrid ta
[s1-Ethernet0/0/1]port hybrid tagged vlan 10 20
[s1-Ethernet0/0/1]
Apr 21 2022 11:57:27-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 13, the change loop count is 0, and the maximum number of records is 4095.
[s1-Ethernet0/0/1]
</code></pre>
<p>在s2上的应用端口也做同样的配置</p>
<pre class=" language-md"><code class="language-md">[s2]int e0/0/2
[s2-Ethernet0/0/2]undo port de vlan 
[s2-Ethernet0/0/2]
Apr 21 2022 11:58:54-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 1, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/2]port link-t h
[s2-Ethernet0/0/2]port h
Apr 21 2022 11:59:14-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 2, the change loop count is 0, and the maximum number of records is 4095. 
[s2-Ethernet0/0/2]port hybrid un
[s2-Ethernet0/0/2]port hybrid untagged vlan 20
[s2-Ethernet0/0/2]port hy
Apr 21 2022 11:59:44-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 3, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/2]port hybrid pv
[s2-Ethernet0/0/2]port hybrid pvid vlan 20
[s2-Ethernet0/0/2]
Apr 21 2022 12:00:04-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 4, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/2]int e0/0/3
[s2-Ethernet0/0/3]undo port de vlan           
[s2-Ethernet0/0/3]port link-t h               
Apr 21 2022 12:00:24-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 5, the change loop count is 0, and the maximum number of recport hybrid untagged                             
[s2-Ethernet0/0/3]port hybrid untagged vlan 20
                       ^
Error: Unrecognized command found at '^' position.
[s2-Ethernet0/0/3]port hybrid untagged vlan 10
                       ^
Error: Unrecognized command found at '^' position.
[s2-Ethernet0/0/3]port link-t h               
[s2-Ethernet0/0/3]port hybrid untagged vlan 10
[s2-Ethernet0/0/3]undo port de vlan           
Apr 21 2022 12:01:54-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 7, the change loop count is 0, and the maximum number ofport hybrid pvid vlan 10
[s2-Ethernet0/0/3]
Apr 21 2022 12:02:04-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 8, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/3]int e0/0/1
[s2-Ethernet0/0/1]port tr
[s2-Ethernet0/0/1]port trunk all
[s2-Ethernet0/0/1]port trunk allow-pass vlan 1 
[s2-Ethernet0/0/1]port link-t h
Error: Please renew the default configurations.
[s2-Ethernet0/0/1]q
[s2]clear configuration interface Ethernet 0/0/1
Warning: All configurations of the interface will be cleared, and its state will be shutdown. Continue? [Y/N] :y
Info: Total execute 2 command(s), 2 successful, 0 failed.
[s2]
Apr 21 2022 13:34:48-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 11, the change loop count is 0, and the maximum number of records is 4095.
Apr 21 2022 13:34:48-08:00 s2 %%01PHY/1/PHY(l)[1]:    Ethernet0/0/1: change status to down
[s2]int e0/0/1
[s2-Ethernet0/0/1]undo shutdown
[s2-Ethernet0/0/1]
Apr 21 2022 13:35:03-08:00 s2 %%01PHY/1/PHY(l)[2]:    Ethernet0/0/1: change status to up
[s2-Ethernet0/0/1]
Apr 21 2022 13:35:08-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 12, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/1]port link-t hy
[s2-Ethernet0/0/1]port hy ta vlan 10 20
[s2-Ethernet0/0/1]
Apr 21 2022 13:35:58-08:00 s2 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 13, the change loop count is 0, and the maximum number of records is 4095.
[s2-Ethernet0/0/1]
</code></pre>
<p>完成后查看一下vlan和接口的对应关系</p>
<pre class=" language-md"><code class="language-md">[s1]dis vlan
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/2(U)     Eth0/0/3(U)     Eth0/0/4(U)     
                Eth0/0/5(D)     Eth0/0/6(D)     Eth0/0/7(D)     Eth0/0/8(D)     
                Eth0/0/9(D)     Eth0/0/10(D)    Eth0/0/11(D)    Eth0/0/12(D)    
                Eth0/0/13(D)    Eth0/0/14(D)    Eth0/0/15(D)    Eth0/0/16(D)    
                Eth0/0/17(D)    Eth0/0/18(D)    Eth0/0/19(D)    Eth0/0/20(D)    
                Eth0/0/21(D)    Eth0/0/22(D)    GE0/0/1(D)      GE0/0/2(D)      
10   common  UT:Eth0/0/3(U)                                                     
             TG:Eth0/0/1(U)                                                     
20   common  UT:Eth0/0/2(U)                                                     
             TG:Eth0/0/1(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
[s1]


[s2-Ethernet0/0/1]dis vlan
The total number of vlans is : 3
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:Eth0/0/1(U)     Eth0/0/2(U)     Eth0/0/3(U)     Eth0/0/4(D)     
                Eth0/0/5(D)     Eth0/0/6(D)     Eth0/0/7(D)     Eth0/0/8(D)     
                Eth0/0/9(D)     Eth0/0/10(D)    Eth0/0/11(D)    Eth0/0/12(D)    
                Eth0/0/13(D)    Eth0/0/14(D)    Eth0/0/15(D)    Eth0/0/16(D)    
                Eth0/0/17(D)    Eth0/0/18(D)    Eth0/0/19(D)    Eth0/0/20(D)    
                Eth0/0/21(D)    Eth0/0/22(D)    GE0/0/1(D)      GE0/0/2(D)      
10   common  UT:Eth0/0/3(U)                                                     
             TG:Eth0/0/1(U)                                                     
20   common  UT:Eth0/0/2(U)                                                     
             TG:Eth0/0/1(U)                                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
[s2-Ethernet0/0/1]
</code></pre>
<p>经过上面的操作后，现在也能够实现access和trunk那套配置的效果了。<br>接下来实现it可以访问任何部门，即在各单位不能互相访问的基础上，只允许vlan30到vlan10和20的单向访问，</p>
<pre class=" language-md"><code class="language-md">[s1]int e0/0/4
[s1-Ethernet0/0/4]vlan 30
[s1-vlan30]
Apr 21 2022 13:46:31-08:00 s1 DS/4/DATASYNC_CFGCHANGE:OID 1.3.6.1.4.1.2011.5.25.191.3.1 configurations have been changed. The current change number is 14, the change loop count is 0, and the maximum number of records is 4095.int e0/0/4
[s1-Ethernet0/0/4]por
[s1-Ethernet0/0/4]port h
[s1-Ethernet0/0/4]port hybrid p
[s1-Ethernet0/0/4]port hybrid pvid vlan 30
[s1-Ethernet0/0/4]
</code></pre>
<h6 id="编辑中……"><a href="#编辑中……" class="headerlink" title="编辑中……"></a>编辑中……</h6><p>（未完待续……）<br><strong>更多内容：</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.baidu.com/">测试测试</a></li>
</ul>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">浮燃</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2022/04/15/hcnalab/">http://example.com/2022/04/15/hcnalab/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">浮燃</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">笔记</span>
                                </a>
                            
                                <a href="/tags/%E7%BD%91%E7%BB%9C/">
                                    <span class="chip bg-color">网络</span>
                                </a>
                            
                                <a href="/tags/%E8%BF%90%E7%BB%B4/">
                                    <span class="chip bg-color">运维</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="qq,qzone,wechat,weibo" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/reward/xalipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/reward/xwechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2022/04/15/hcnalab/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/featureimages/23.jpg" class="responsive-img" alt="《HCNA网络技术实验指南》实验">
                        
                        <span class="card-title">《HCNA网络技术实验指南》实验</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            要点梳理
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-04-15
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">
                                    笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                    <a href="/tags/%E7%BD%91%E7%BB%9C/">
                        <span class="chip bg-color">网络</span>
                    </a>
                    
                    <a href="/tags/%E8%BF%90%E7%BB%B4/">
                        <span class="chip bg-color">运维</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/03/23/hcna/">
                    <div class="card-image">
                        
                        
                        <img src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/medias/featureimages/2.jpg" class="responsive-img" alt="《HCNA网络技术实验指南》梳理">
                        
                        <span class="card-title">《HCNA网络技术实验指南》梳理</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            要点梳理
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-03-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%AC%94%E8%AE%B0/" class="post-category">
                                    笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                    <a href="/tags/%E7%BD%91%E7%BB%9C/">
                        <span class="chip bg-color">网络</span>
                    </a>
                    
                    <a href="/tags/%E8%BF%90%E7%BB%B4/">
                        <span class="chip bg-color">运维</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <!-- card style="background-color: white;" -->
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录
            </div>
            <div id="toc-content" class="style-scrollbar"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

    <div id="floating-toc-btn" class="hide-on-med-and-down">
        <a class="btn-floating btn-large bg-color">
            <i class="fas fa-list-ul"></i>
        </a>
    </div>
    

        <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/tocbot/tocbot.min.js"></script>
        <script>
            $(function () {
                tocbot.init({
                    tocSelector: '#toc-content',
                    contentSelector: '#articleContent',
                    headingsOffset: -($(window).height() * 0.4 - 45),
                    collapseDepth: Number('2'),
                    headingSelector: 'h6, h5, h4, h3, h2'
                });

                // modify the toc link href to support Chinese.
                let i = 0;
                let tocHeading = 'toc-heading-';
                $('#toc-content a').each(function () {
                    $(this).attr('href', '#' + tocHeading + (++i));
                });

                // modify the heading title id to support Chinese.
                i = 0;
                $('#articleContent').children('h6, h5, h4, h3, h2').each(function () {
                    $(this).attr('id', tocHeading + (++i));
                });

                // Set scroll toc fixed.
                let tocHeight = parseInt($(window).height() * 0.4 - 64);
                let $tocWidget = $('.toc-widget');
                $(window).scroll(function () {
                    let scroll = $(window).scrollTop();
                    /* add post toc fixed. */
                    if (scroll > tocHeight) {
                        $tocWidget.addClass('toc-fixed');
                    } else {
                        $tocWidget.removeClass('toc-fixed');
                    }
                });

        
                    /* 修复文章卡片 div 的宽度. */
                    let fixPostCardWidth = function (srcId, targetId) {
                        let srcDiv = $('#' + srcId);
                        if (srcDiv.length === 0) {
                            return;
                        }

                        let w = srcDiv.width();
                        if (w >= 450) {
                            w = w + 21;
                        } else if (w >= 350 && w < 450) {
                            w = w + 18;
                        } else if (w >= 300 && w < 350) {
                            w = w + 16;
                        } else {
                            w = w + 14;
                        }
                        $('#' + targetId).width(w);
                    };

                    // 切换TOC目录展开收缩的相关操作.
                    const expandedClass = 'expanded';
                    let $tocAside = $('#toc-aside');
                    let $mainContent = $('#main-content');
                    $('#floating-toc-btn .btn-floating').click(function () {
                        if ($tocAside.hasClass(expandedClass)) {
                            $tocAside.removeClass(expandedClass).hide();
                            $mainContent.removeClass('l9');
                        } else {
                            $tocAside.addClass(expandedClass).show();
                            $mainContent.addClass('l9');
                        }
                        fixPostCardWidth('artDetail', 'prenext-posts');
                    });
        
    });
        </script>
    

</main>




    <footer class="page-footer bg-color">
    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="copy-right"> <!-- col s12 m8 l8 -->
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2022</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">浮燃</a>
            <!-- |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a> -->
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">34.4k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv" style='display:none'>
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv" style='display:none'>
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "6";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <!-- <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:siangmeng25@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1878786663" class="tooltipped" target="_blank" data-tooltip="QQ联系我" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/u/7730402752" class="tooltipped" target="_blank" data-tooltip="关注我的微博" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>






</div> -->
    </div>
</footer>

<div class="progress-bar"></div>

<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);  // 50ms周期检测函数
        var pvcountOffset = 0;  // 初始化首次总访问量数据
        var uvcountOffset = 0;  // 初始化首次总访问人数数据

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int); // 停止检测
            }
        }
    });
</script>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title' target='_blank'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>

    <script type="text/javascript">
        var OriginTitile = document.title,
            st;
        document.addEventListener("visibilitychange", function () {
            document.hidden ? (document.title = "怎么走了，不爱我了吗🥺🥺🥺", clearTimeout(st)) : (document.title =
                "我知道你会回来的😊😊😊", st = setTimeout(function () {
                    document.title = OriginTitile
                }, 3e3))
        })
    </script>
    <script type="text/javascript">
        //禁止Ctrl+U
        var arr = [123, 17, 18];
        document.oncontextmenu = new Function("event.returnValue=false;");//禁用右键

        window.onkeydown = function (e) {
            var keyCode = e.keyCode || e.which || e.charCode;
            var ctrlKey = e.ctrlKey || e.metaKey;
            console.log(keyCode + "--" + keyCode);
            if (ctrlKey && keyCode == 85) {
                e.preventDefault();
            }
            if (arr.indexOf(keyCode) > -1) {
                e.preventDefault();
            }
            //禁用ctrl+shift+i,
            if (window.event.ctrlKey && window.event.shiftKey && window.event.keyCode == 73) {
                return false;
            //屏蔽Shift+F10
            } else if (window.event.shiftKey && window.event.keyCode == 121) {
                return false;
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/materialize/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/aos/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    
    <script async src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/others/busuanzi.pure.mini.js"></script>
    

    

        <!-- 鼠标点击烟花爆炸效果 -->
        

        <!-- 背景樱花飘落特效 -->
        

        <!-- 鼠标点击文字特效 -->
        
            <script src="/js/wenzi.js" type="text/javascript"></script>
        

        <!-- 背景雪花飘落特效 -->
        

    

	
    

    

    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="https://cdn.jsdelivr.net/gh/jason-663/jason-663.github.io/libs/instantpage/instantpage.js" type="module"></script>
    


<!-- 深色模式按钮 -->
<script>
    if (localStorage.getItem('dark') === '1') {
    document.body.classList.add('dark');
    }
    else if (new Date().getHours() >= 22 || new Date().getHours() < 7) {
    document.body.classList.add('dark');
    } 
    else if (matchMedia('(prefers-color-scheme: dark)').matches) {
    document.body.classList.add('dark');
    }
</script>
<a onclick="switchNightMode()" id="sma">
    <i class="fas fa-lightbulb" id="nightMode" aria-hidden="true"></i>
</a>

</body>

</html>

